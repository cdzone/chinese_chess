# AI æœ¬åœ°åŒ–æ–¹æ¡ˆ

## æ–‡æ¡£ä¿¡æ¯

- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
- **åˆ›å»ºæ—¥æœŸ**: 2026-01-10
- **çŠ¶æ€**: å¾…è®¨è®º
- **ç›®æ ‡**: å°† PvE æ¨¡å¼çš„ AI ä»æœåŠ¡ç«¯è¿ç§»åˆ°å®¢æˆ·ç«¯æœ¬åœ°è¿è¡Œ

---

## ä¸€ã€èƒŒæ™¯ä¸é—®é¢˜

### 1.1 å½“å‰æ¶æ„

å½“å‰ PvE æ¨¡å¼é‡‡ç”¨**æœåŠ¡ç«¯æ‰˜ç®¡ AI** çš„æ¶æ„ï¼š

```
å®¢æˆ·ç«¯                      æœåŠ¡ç«¯
  |                          |
  |---èµ°æ£‹-----------------â†’ |
  |                          |-- AI è®¡ç®—ï¼ˆé˜»å¡ 1-5 ç§’ï¼‰
  |                          |
  |â†--AI èµ°æ³•--------------- |
```

**å®ç°ä½ç½®**ï¼š
- `chess-server/src/server.rs:537-651` - AI èµ°æ£‹é€»è¾‘
- `chess-ai/` - AI å¼•æ“åº“

### 1.2 å­˜åœ¨çš„é—®é¢˜

| é—®é¢˜ | æè¿° | å½±å“ |
|------|------|------|
| **æœåŠ¡å™¨è´Ÿè½½é«˜** | æ¯ä¸ª AI å¯¹å±€æ¶ˆè€— CPU 1-5 ç§’/æ­¥ | 100 å¹¶å‘å¯¹å±€ä¼šä¸¥é‡å½±å“æ€§èƒ½ |
| **å»¶è¿Ÿä½“éªŒå·®** | ç½‘ç»œå¾€è¿” + AI è®¡ç®—æ—¶é—´ | ç”¨æˆ·ç­‰å¾…æ—¶é—´é•¿ |
| **æˆæœ¬é«˜** | æœåŠ¡å™¨éœ€è¦å¼º CPU | è¿è¥æˆæœ¬å¢åŠ  |
| **ç¦»çº¿ä¸å¯ç”¨** | å¿…é¡»è¿æ¥æœåŠ¡å™¨ | å•æœºå¯¹æˆ˜æ— æ³•å®ç° |
| **å¹¶å‘é—®é¢˜** | è™½å·²ä½¿ç”¨ `block_in_place` | ä½†ä»å ç”¨æœåŠ¡å™¨èµ„æº |

### 1.3 ä¸ºä»€ä¹ˆè¦æœ¬åœ°åŒ–

**ä¼˜åŠ¿åˆ†æ**ï¼š

âœ… **æ€§èƒ½æå‡**
- åˆ©ç”¨å®¢æˆ·ç«¯ CPUï¼ŒæœåŠ¡å™¨å‹åŠ›é™ä¸º 0
- æ²¡æœ‰ç½‘ç»œå»¶è¿Ÿï¼ŒAI å“åº”æ›´å¿«
- å¯æ ¹æ®å®¢æˆ·ç«¯ç¡¬ä»¶è°ƒæ•´éš¾åº¦

âœ… **æˆæœ¬é™ä½**
- æœåŠ¡å™¨åªå¤„ç†ç½‘ç»œæ¶ˆæ¯
- å¯ä½¿ç”¨å»‰ä»·è½»é‡çº§æœåŠ¡å™¨
- å®¢æˆ·ç«¯ç®—åŠ›å…è´¹

âœ… **ç¦»çº¿å¯ç”¨**
- å•æœºæ¨¡å¼å®Œå…¨ä¸éœ€è¦ç½‘ç»œ
- ç½‘ç»œæ–­å¼€å¯ç»§ç»­æ¸¸æˆ
- é€‚åˆç§»åŠ¨ç«¯å¼±ç½‘ç¯å¢ƒ

âœ… **éšç§ä¿æŠ¤**
- æ£‹è°±ä¸éœ€è¦ä¸Šä¼ æœåŠ¡å™¨
- å¯é€‰æ‹©æ˜¯å¦è”ç½‘

---

## äºŒã€æŠ€æœ¯æ–¹æ¡ˆ

### 2.1 æ¶æ„è®¾è®¡

#### æ··åˆæ¨¡å¼æ¶æ„ï¼ˆæ¨èï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å®¢æˆ·ç«¯                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¸¸æˆæ¨¡å¼                           â”‚
â”‚  â”œâ”€â”€ LocalPvEï¼ˆæœ¬åœ° AIï¼‰â­ ä¸»è¦    â”‚
â”‚  â”œâ”€â”€ OnlinePvEï¼ˆåœ¨çº¿ AIï¼‰å¤‡é€‰      â”‚
â”‚  â””â”€â”€ OnlinePvPï¼ˆåœ¨çº¿å¯¹æˆ˜ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LocalPvE æµç¨‹ï¼š
å®¢æˆ·ç«¯ UI â†’ ClientGame â†’ AI Engine â†’ è¿”å›èµ°æ³• â†’ æ›´æ–°æ£‹ç›˜
ï¼ˆå®Œå…¨æœ¬åœ°ï¼Œæ— ç½‘ç»œï¼‰

OnlinePvE æµç¨‹ï¼š
å®¢æˆ·ç«¯ UI â†’ ç½‘ç»œå±‚ â†’ æœåŠ¡å™¨ â†’ AI Engine â†’ è¿”å›èµ°æ³• â†’ å®¢æˆ·ç«¯
ï¼ˆä¿ç•™ç°æœ‰é€»è¾‘ï¼‰
```

### 2.2 æ ¸å¿ƒæ•°æ®ç»“æ„

```rust
// chess-client/src/game/state.rs
#[derive(Clone, Debug)]
pub enum GameMode {
    /// æœ¬åœ°å•æœº AIï¼ˆæ¨èï¼‰
    LocalPvE {
        difficulty: Difficulty,
    },
    /// åœ¨çº¿ AIï¼ˆä¿ç•™ï¼‰
    OnlinePvE {
        room_id: RoomId,
    },
    /// åœ¨çº¿å¯¹æˆ˜
    OnlinePvP {
        room_id: RoomId,
    },
}

impl ClientGame {
    /// åˆ¤æ–­æ˜¯å¦éœ€è¦ AI èµ°æ£‹
    pub fn should_ai_move(&self) -> bool {
        matches!(self.mode, GameMode::LocalPvE { .. })
            && self.is_ai_turn()
            && !self.is_paused
    }

    /// åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬åœ°æ¨¡å¼
    pub fn is_local(&self) -> bool {
        matches!(self.mode, GameMode::LocalPvE { .. })
    }
}
```

### 2.3 AI ç³»ç»Ÿå®ç°

#### æ–‡ä»¶ç»“æ„

```
chess-client/src/game/
â”œâ”€â”€ mod.rs           # æ¸¸æˆæ’ä»¶
â”œâ”€â”€ state.rs         # æ¸¸æˆçŠ¶æ€
â”œâ”€â”€ input.rs         # è¾“å…¥å¤„ç†
â”œâ”€â”€ ai.rs            # AI ç³»ç»Ÿï¼ˆæ–°å¢ï¼‰â­
â””â”€â”€ local_ai.rs      # æœ¬åœ° AI é€»è¾‘ï¼ˆæ–°å¢ï¼‰â­
```

#### æ ¸å¿ƒä»£ç 

```rust
// chess-client/src/game/ai.rs
use bevy::prelude::*;
use bevy::tasks::{AsyncComputeTaskPool, Task};
use chess_ai::AiEngine;
use protocol::{BoardState, Move, Difficulty};

/// AI è®¡ç®—ä»»åŠ¡ç»„ä»¶
#[derive(Component)]
pub struct AiComputeTask {
    task: Task<Option<Move>>,
    started_at: std::time::Instant,
}

/// AI æ’ä»¶
pub struct AiPlugin;

impl Plugin for AiPlugin {
    fn build(&self, app: &mut App) {
        app.add_systems(Update, (
            trigger_ai_compute,
            poll_ai_result,
        ).run_if(in_state(GameState::Playing)));
    }
}

/// è§¦å‘ AI è®¡ç®—
fn trigger_ai_compute(
    game: Res<ClientGame>,
    mut commands: Commands,
    existing_tasks: Query<&AiComputeTask>,
) {
    // é˜²æ­¢é‡å¤è§¦å‘
    if !existing_tasks.is_empty() {
        return;
    }

    // æ£€æŸ¥æ˜¯å¦éœ€è¦ AI èµ°æ£‹
    if !game.should_ai_move() {
        return;
    }

    let game_state = game.board_state.clone();
    let difficulty = match game.mode {
        GameMode::LocalPvE { difficulty } => difficulty,
        _ => return,
    };

    // åœ¨åå°çº¿ç¨‹æ± ä¸­è®¡ç®—ï¼ˆä¸é˜»å¡æ¸²æŸ“ï¼‰
    let task_pool = AsyncComputeTaskPool::get();
    let task = task_pool.spawn(async move {
        let mut engine = AiEngine::from_difficulty(difficulty);
        engine.search(&game_state)
    });

    commands.spawn(AiComputeTask {
        task,
        started_at: std::time::Instant::now(),
    });

    tracing::info!("AI å¼€å§‹æ€è€ƒ... éš¾åº¦: {:?}", difficulty);
}

/// è½®è¯¢ AI ç»“æœ
fn poll_ai_result(
    mut commands: Commands,
    mut tasks: Query<(Entity, &mut AiComputeTask)>,
    mut game: ResMut<ClientGame>,
    mut game_events: EventWriter<GameEvent>,
) {
    use futures_lite::future::poll_once;

    for (entity, mut task) in &mut tasks {
        if let Some(ai_move) = block_on(poll_once(&mut task.task)) {
            let elapsed = task.started_at.elapsed();

            match ai_move {
                Some(mv) => {
                    tracing::info!("AI èµ°æ£‹: {:?}, è€—æ—¶: {:?}", mv, elapsed);

                    // å‘é€èµ°æ£‹äº‹ä»¶ï¼ˆå¤ç”¨ç°æœ‰äº‹ä»¶ç³»ç»Ÿï¼‰
                    game_events.send(GameEvent::MakeMove {
                        from: mv.from,
                        to: mv.to,
                    });
                }
                None => {
                    tracing::warn!("AI æ— æ³•æ‰¾åˆ°åˆæ³•èµ°æ³•ï¼Œç©å®¶èƒœåˆ©");
                    // TODO: è§¦å‘æ¸¸æˆç»“æŸäº‹ä»¶
                }
            }

            // æ¸…ç†ä»»åŠ¡
            commands.entity(entity).despawn();
        }
    }
}
```

### 2.4 UI é›†æˆ

#### èœå•è°ƒæ•´

```rust
// chess-client/src/ui/menu.rs

/// ä¸»èœå•å¸ƒå±€ï¼ˆè°ƒæ•´åï¼‰
///
/// â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
/// â”‚    ä¸­å›½è±¡æ£‹              â”‚
/// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
/// â”‚  å•æœºå¯¹æˆ˜ â­ï¼ˆæ¨èï¼‰     â”‚
/// â”‚    â”œâ”€ ç®€å•              â”‚
/// â”‚    â”œâ”€ ä¸­ç­‰              â”‚
/// â”‚    â””â”€ å›°éš¾              â”‚
/// â”‚                         â”‚
/// â”‚  åœ¨çº¿å¯¹æˆ˜               â”‚
/// â”‚    â”œâ”€ å¿«é€ŸåŒ¹é…          â”‚
/// â”‚    â”œâ”€ åˆ›å»ºæˆ¿é—´          â”‚
/// â”‚    â””â”€ åŠ å…¥æˆ¿é—´          â”‚
/// â”‚                         â”‚
/// â”‚  å…¶ä»–                   â”‚
/// â”‚    â”œâ”€ åŠ è½½æ¸¸æˆ          â”‚
/// â”‚    â””â”€ é€€å‡º              â”‚
/// â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

fn spawn_local_pve_buttons(
    parent: &mut ChildBuilder,
    theme: &ColorTheme,
    asset_server: &AssetServer,
) {
    // "å•æœºå¯¹æˆ˜"æ ‡é¢˜
    parent.spawn((
        Text::new("å•æœºå¯¹æˆ˜ â­"),
        TextFont {
            font: asset_server.load("fonts/NotoSerifSC-Bold.ttf"),
            font_size: 28.0,
            ..default()
        },
        TextColor(theme.text_primary),
    ));

    // éš¾åº¦æŒ‰é’®
    for (label, difficulty) in [
        ("ç®€å•", Difficulty::Easy),
        ("ä¸­ç­‰", Difficulty::Medium),
        ("å›°éš¾", Difficulty::Hard),
    ] {
        spawn_menu_button(
            parent,
            label,
            MenuAction::StartLocalPvE(difficulty),
            theme,
            asset_server,
        );
    }
}

// å¤„ç†èœå•åŠ¨ä½œ
fn handle_menu_action(action: MenuAction) {
    match action {
        MenuAction::StartLocalPvE(difficulty) => {
            // ç›´æ¥è¿›å…¥æ¸¸æˆï¼Œæ— éœ€ç½‘ç»œ
            game.start_local_pve(difficulty);
            next_state.set(GameState::Playing);
        }
        // ... å…¶ä»–åŠ¨ä½œ
    }
}
```

### 2.5 æ€§èƒ½ä¼˜åŒ–

#### ä½¿ç”¨ Bevy ä»»åŠ¡ç³»ç»Ÿ

```rust
// æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ AsyncComputeTaskPoolï¼ˆæ¨èï¼‰
let task = AsyncComputeTaskPool::get().spawn(async move {
    // AI è®¡ç®—åœ¨ç‹¬ç«‹çº¿ç¨‹æ± ä¸­è¿è¡Œ
    let mut engine = AiEngine::from_difficulty(difficulty);
    engine.search(&game_state)
});

// æ–¹æ¡ˆ 2ï¼šä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼ˆå¤‡é€‰ï¼‰
use rayon::prelude::*;

lazy_static! {
    static ref AI_THREAD_POOL: rayon::ThreadPool = {
        rayon::ThreadPoolBuilder::new()
            .num_threads(2)
            .build()
            .unwrap()
    };
}

let result = AI_THREAD_POOL.install(|| {
    let mut engine = AiEngine::from_difficulty(difficulty);
    engine.search(&game_state)
});
```

#### AI æ€è€ƒæŒ‡ç¤ºå™¨

```rust
// æ˜¾ç¤º"AI æ€è€ƒä¸­..."åŠ¨ç”»
fn show_ai_thinking_indicator(
    mut commands: Commands,
    tasks: Query<&AiComputeTask>,
    theme: Res<ColorTheme>,
) {
    if tasks.is_empty() {
        return;
    }

    commands.spawn((
        Text::new("AI æ€è€ƒä¸­..."),
        TextFont {
            font_size: 24.0,
            ..default()
        },
        Node {
            position_type: PositionType::Absolute,
            top: Val::Px(50.0),
            left: Val::Px(50.0),
            ..default()
        },
        ThinkingIndicator,
    ));
}
```

---

## ä¸‰ã€å®æ–½è®¡åˆ’

### 3.1 Phase 1ï¼šåŸºç¡€åŠŸèƒ½ï¼ˆé¢„è®¡ 2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°æœ¬åœ° AI åŸºç¡€åŠŸèƒ½

| ä»»åŠ¡ | å·¥ä½œé‡ | æ–‡ä»¶ |
|------|--------|------|
| æ·»åŠ  GameMode æšä¸¾ | 1h | `game/state.rs` |
| å®ç° AI æ’ä»¶ | 2h | `game/ai.rs` (æ–°å¢) |
| é›†æˆ chess-ai ä¾èµ– | 0.5h | `Cargo.toml` |
| è°ƒæ•´èœå• UI | 2h | `ui/menu.rs` |
| åŸºç¡€æµ‹è¯• | 2h | æ‰‹åŠ¨æµ‹è¯• |

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… å¯ä»¥ä»èœå•å¯åŠ¨æœ¬åœ° PvE
- âœ… AI èƒ½æ­£ç¡®èµ°æ£‹
- âœ… æ¸¸æˆæµç¨‹å®Œæ•´ï¼ˆèµ°æ£‹ã€åƒå­ã€å°†å†›ã€èƒœè´Ÿï¼‰

### 3.2 Phase 2ï¼šä¼˜åŒ–ä½“éªŒï¼ˆé¢„è®¡ 1-2 å¤©ï¼‰

**ç›®æ ‡**ï¼šæå‡ç”¨æˆ·ä½“éªŒ

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| AI æ€è€ƒæŒ‡ç¤ºå™¨ | 1h | æ˜¾ç¤º"æ€è€ƒä¸­..."åŠ¨ç”» |
| æ€§èƒ½ä¼˜åŒ– | 2h | ç¡®ä¿ä¸å¡é¡¿ |
| æš‚åœ/æ¢å¤æ”¯æŒ | 1h | æœ¬åœ°æ¨¡å¼æš‚åœ |
| æ‚”æ£‹æ”¯æŒ | 1h | æœ¬åœ°æ¨¡å¼æ‚”æ£‹ |
| é”™è¯¯å¤„ç† | 1h | AI å¤±è´¥æç¤º |

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… AI æ€è€ƒæ—¶æœ‰è§†è§‰åé¦ˆ
- âœ… æ¸¸æˆæµç•…ä¸å¡é¡¿
- âœ… æ”¯æŒæš‚åœã€æ‚”æ£‹
- âœ… å¼‚å¸¸æƒ…å†µæœ‰å‹å¥½æç¤º

### 3.3 Phase 3ï¼šå®Œå–„åŠŸèƒ½ï¼ˆé¢„è®¡ 1-2 å¤©ï¼Œå¯é€‰ï¼‰

**ç›®æ ‡**ï¼šé«˜çº§åŠŸèƒ½

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| ä¿å­˜/åŠ è½½æœ¬åœ°æ¸¸æˆ | 2h | æ”¯æŒæœ¬åœ°æ¨¡å¼ |
| AI å¼ºåº¦è°ƒèŠ‚ | 1h | è¿è¡Œæ—¶è°ƒæ•´éš¾åº¦ |
| ç»Ÿè®¡æ•°æ® | 2h | èƒœç‡ã€ç”¨æ—¶ç­‰ |
| AI æç¤ºåŠŸèƒ½ | 2h | æ˜¾ç¤º AI æ¨èèµ°æ³• |

---

## å››ã€å…¼å®¹æ€§è®¾è®¡

### 4.1 ä¿ç•™åœ¨çº¿ PvE

**åŸå› **ï¼š
1. ç”¨äº AI å¤©æ¢¯æ’åï¼ˆéœ€è¦æœåŠ¡å™¨éªŒè¯é˜²ä½œå¼Šï¼‰
2. è·¨è®¾å¤‡åŒæ­¥è¿›åº¦
3. é«˜çº§äº‘ç«¯ AI

**å®ç°**ï¼šä¿æŒç°æœ‰ä»£ç ä¸å˜ï¼Œä½œä¸ºå¤‡é€‰æ¨¡å¼

### 4.2 ç»Ÿä¸€æ¥å£

```rust
// æ¸¸æˆé€»è¾‘å±‚ä¸å…³å¿ƒ AI æ¥æº
pub trait AiProvider {
    fn compute_move(&self, state: &BoardState) -> Option<Move>;
}

// æœ¬åœ° AI
struct LocalAi { engine: AiEngine }

// åœ¨çº¿ AI
struct RemoteAi { network: NetworkConnection }
```

### 4.3 æ¸è¿›å¼è¿ç§»

```
é˜¶æ®µ 1ï¼šæœ¬åœ° AI å®ç°
  â†“
é˜¶æ®µ 2ï¼šé»˜è®¤ä½¿ç”¨æœ¬åœ°ï¼Œä¿ç•™åœ¨çº¿é€‰é¡¹
  â†“
é˜¶æ®µ 3ï¼šæ ¹æ®åé¦ˆå†³å®šæ˜¯å¦ç§»é™¤åœ¨çº¿ AI
```

---

## äº”ã€é£é™©è¯„ä¼°

### 5.1 æŠ€æœ¯é£é™©

| é£é™© | ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|----------|
| ä½ç«¯è®¾å¤‡å¡é¡¿ | ğŸŸ¡ ä¸­ | è°ƒæ•´æœç´¢æ·±åº¦ï¼Œä¼˜åŒ–ç®—æ³• |
| å†…å­˜å ç”¨è¿‡é«˜ | ğŸŸ¢ ä½ | ç½®æ¢è¡¨å¤§å°å¯é…ç½® |
| ç”µé‡æ¶ˆè€— | ğŸŸ¢ ä½ | ç§»åŠ¨ç«¯é™ä½æœç´¢æ·±åº¦ |
| é›†æˆå¤æ‚åº¦ | ğŸŸ¢ ä½ | chess-ai å·²ç»ç‹¬ç«‹ï¼Œæ˜“é›†æˆ |

### 5.2 äº§å“é£é™©

| é£é™© | ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|----------|
| ä½œå¼Šé—®é¢˜ | ğŸŸ¢ ä½ | å•æœºæ¨¡å¼æ— æ‰€è°“ï¼Œæ’åèµ›ç”¨åœ¨çº¿ AI |
| ç‰ˆæœ¬ä¸ä¸€è‡´ | ğŸŸ¢ ä½ | AI ç‰ˆæœ¬å·ç®¡ç† |
| ç”¨æˆ·ä¹ æƒ¯æ”¹å˜ | ğŸŸ¢ ä½ | ä¿ç•™åœ¨çº¿æ¨¡å¼ä½œä¸ºè¿‡æ¸¡ |

### 5.3 è¿è¥é£é™©

| é£é™© | ç­‰çº§ | å½±å“ |
|------|------|------|
| æœåŠ¡å™¨è´Ÿè½½é™ä½ | âœ… æ­£é¢ | æˆæœ¬å¤§å¹…ä¸‹é™ |
| ç¦»çº¿ç”¨æˆ·å¢åŠ  | âœ… æ­£é¢ | ç”¨æˆ·ä½“éªŒæå‡ |
| æ•°æ®æ”¶é›†å‡å°‘ | ğŸŸ¡ ä¸­æ€§ | å¯ä¿ç•™å¯é€‰ä¸ŠæŠ¥ |

---

## å…­ã€æ€§èƒ½å¯¹æ¯”

### 6.1 å»¶è¿Ÿå¯¹æ¯”

| æ¨¡å¼ | ç½‘ç»œå»¶è¿Ÿ | AI è®¡ç®— | æ€»å»¶è¿Ÿ |
|------|---------|---------|--------|
| **åœ¨çº¿ AI** | 50-200ms | 1-5s | 1.05-5.2s |
| **æœ¬åœ° AI** | 0ms | 1-5s | 1-5s â¬‡ï¸ |

**æå‡**: å‡å°‘ 50-200ms ç½‘ç»œå»¶è¿Ÿ

### 6.2 æœåŠ¡å™¨è´Ÿè½½å¯¹æ¯”

å‡è®¾ 100 ä¸ªå¹¶å‘ AI å¯¹å±€ï¼š

| æ¨¡å¼ | CPU å ç”¨ | å†…å­˜å ç”¨ | ç½‘ç»œå¸¦å®½ |
|------|---------|---------|----------|
| **åœ¨çº¿ AI** | 100 ä¸ªè®¡ç®—ä»»åŠ¡ | 6.4GB | æ­£å¸¸ |
| **æœ¬åœ° AI** | 0 | 0 | æ­£å¸¸ |

**èŠ‚çœ**: æœåŠ¡å™¨ AI ç®—åŠ› 100%

### 6.3 å®¢æˆ·ç«¯æ€§èƒ½

| è®¾å¤‡ç­‰çº§ | FPS å½±å“ | å»ºè®® |
|---------|---------|------|
| é«˜ç«¯è®¾å¤‡ | æ— å½±å“ | å›°éš¾éš¾åº¦ |
| ä¸­ç«¯è®¾å¤‡ | è½»å¾®å¡é¡¿ï¼ˆ<100msï¼‰ | ä¸­ç­‰éš¾åº¦ |
| ä½ç«¯è®¾å¤‡ | å¶å°”å¡é¡¿ï¼ˆ<500msï¼‰ | ç®€å•éš¾åº¦ |

**ä¼˜åŒ–æ–¹æ¡ˆ**: æ ¹æ®è®¾å¤‡æ€§èƒ½è‡ªåŠ¨æ¨èéš¾åº¦

---

## ä¸ƒã€æˆæœ¬æ”¶ç›Šåˆ†æ

### 7.1 å¼€å‘æˆæœ¬

| é¡¹ç›® | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| æ ¸å¿ƒå¼€å‘ | 2-3 å¤© | åŸºç¡€åŠŸèƒ½ |
| ä¼˜åŒ–æµ‹è¯• | 1-2 å¤© | ä½“éªŒä¼˜åŒ– |
| **æ€»è®¡** | **3-5 å¤©** | 1 äººå®Œæˆ |

### 7.2 è¿è¥æ”¶ç›Š

**æœåŠ¡å™¨æˆæœ¬èŠ‚çœ**ï¼ˆæœˆåº¦ï¼‰ï¼š

å‡è®¾ï¼š
- æ—¥å‡ 1000 å±€ AI å¯¹æˆ˜
- æœåŠ¡å™¨ CPU æˆæœ¬ï¼š$0.05/æ ¸å¿ƒæ—¶
- å¹³å‡æ¯å±€ 20 æ­¥ï¼Œæ¯æ­¥ 2 ç§’ = 40 ç§’ CPU
- æœˆåº¦ CPU æ—¶é—´ï¼š1000 å±€/å¤© Ã— 30 å¤© Ã— 40 ç§’ = 1,200,000 ç§’ = 333 å°æ—¶

**èŠ‚çœæˆæœ¬**: $0.05 Ã— 333 = **$16.65/æœˆ**

**å¹´åº¦èŠ‚çœ**: **$200**

è™½ç„¶ç»å¯¹å€¼ä¸å¤§ï¼Œä½†ï¼š
1. æœåŠ¡å™¨å¯ä»¥ç”¨æ›´ä¾¿å®œçš„é…ç½®
2. å¯æ”¯æŒæ›´å¤šç”¨æˆ·
3. ç”¨æˆ·ä½“éªŒæå‡å¸¦æ¥çš„ç•™å­˜ä»·å€¼

---

## å…«ã€å®æ–½å»ºè®®

### 8.1 æ¨èæ–¹æ¡ˆ

**ç«‹å³å®æ–½æœ¬åœ° AI**ï¼Œç†ç”±ï¼š
1. âœ… å¼€å‘æˆæœ¬ä½ï¼ˆ3-5 å¤©ï¼‰
2. âœ… é£é™©å¯æ§ï¼ˆä¸ç ´åç°æœ‰åŠŸèƒ½ï¼‰
3. âœ… æ”¶ç›Šæ˜æ˜¾ï¼ˆæ€§èƒ½ã€ä½“éªŒã€æˆæœ¬ï¼‰
4. âœ… ç”¨æˆ·éœ€æ±‚å¼ºï¼ˆç¦»çº¿æ¸¸æˆï¼‰

### 8.2 å®æ–½è·¯å¾„

```
ç¬¬ 1 å¤©: Phase 1 åŸºç¡€åŠŸèƒ½
  â”œâ”€ ä¸Šåˆ: å®ç° AI ç³»ç»Ÿ
  â”œâ”€ ä¸‹åˆ: é›†æˆèœå•
  â””â”€ æ™šä¸Š: åŸºç¡€æµ‹è¯•

ç¬¬ 2 å¤©: Phase 2 ä¼˜åŒ–ä½“éªŒ
  â”œâ”€ ä¸Šåˆ: æ€è€ƒæŒ‡ç¤ºå™¨ + æ€§èƒ½ä¼˜åŒ–
  â”œâ”€ ä¸‹åˆ: æš‚åœ/æ‚”æ£‹æ”¯æŒ
  â””â”€ æ™šä¸Š: å®Œæ•´æµ‹è¯•

ç¬¬ 3-5 å¤©: Phase 3 å®Œå–„åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
  â””â”€ ä¿å­˜åŠ è½½ã€ç»Ÿè®¡ã€AI æç¤º
```

### 8.3 å›æ»šç­–ç•¥

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. ä¿ç•™åœ¨çº¿ AI ä½œä¸ºå¤‡é€‰
2. å¯ä»¥éšæ—¶åˆ‡æ¢å›åœ¨çº¿æ¨¡å¼
3. ä»£ç æ”¹åŠ¨ç‹¬ç«‹ï¼Œæ˜“äºå›æ»š

---

## ä¹ã€åç»­è§„åˆ’

### 9.1 çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰

- [ ] å®æ–½æœ¬åœ° AI åŸºç¡€åŠŸèƒ½
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] æ€§èƒ½æ•°æ®ç›‘æ§

### 9.2 ä¸­æœŸï¼ˆ1-2 æœˆï¼‰

- [ ] æ ¹æ®åé¦ˆä¼˜åŒ– AI å¼ºåº¦
- [ ] å®ç° AI æç¤ºåŠŸèƒ½
- [ ] æ·»åŠ ç»Ÿè®¡é¢æ¿

### 9.3 é•¿æœŸï¼ˆ3-6 æœˆï¼‰

- [ ] è¯„ä¼°æ˜¯å¦ç§»é™¤åœ¨çº¿ AI
- [ ] å¼€å‘æ›´å¼ºçš„ AI ç®—æ³•
- [ ] æ”¯æŒè‡ªå®šä¹‰ AI æ’ä»¶

---

## åã€è®¨è®ºè®®é¢˜

### å¾…è®¨è®ºçš„é—®é¢˜

1. **ä¼˜å…ˆçº§ç¡®è®¤**
   - æ˜¯å¦ç«‹å³å®æ–½æœ¬åœ° AIï¼Ÿ
   - Phase 3 çš„é«˜çº§åŠŸèƒ½æ˜¯å¦éœ€è¦ï¼Ÿ

2. **åŠŸèƒ½å–èˆ**
   - æ˜¯å¦ä¿ç•™åœ¨çº¿ AIï¼Ÿ
   - æ˜¯å¦éœ€è¦ AI å¤©æ¢¯æ’åï¼Ÿ

3. **æ€§èƒ½æ ‡å‡†**
   - å¯æ¥å—çš„å¡é¡¿æ—¶é—´ï¼Ÿ
   - ä¸åŒè®¾å¤‡çš„éš¾åº¦å»ºè®®ï¼Ÿ

4. **å®æ–½æ—¶æœº**
   - åœ¨ Phase 4 å®Œæˆåï¼Ÿ
   - è¿˜æ˜¯ä½œä¸º Phase 5 çš„å†…å®¹ï¼Ÿ

---

## é™„å½•

### A. ç›¸å…³æ–‡ä»¶æ¸…å•

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š
- `chess-client/src/game/mod.rs`
- `chess-client/src/game/state.rs`
- `chess-client/src/ui/menu.rs`
- `chess-client/Cargo.toml`

**éœ€è¦æ–°å¢çš„æ–‡ä»¶**ï¼š
- `chess-client/src/game/ai.rs`
- `chess-client/src/game/local_ai.rs`

**æ— éœ€ä¿®æ”¹**ï¼š
- æœåŠ¡ç«¯æ‰€æœ‰ä»£ç ï¼ˆä¿ç•™ç°æœ‰é€»è¾‘ï¼‰
- protocol å±‚ï¼ˆæ— éœ€æ”¹åŠ¨ï¼‰

### B. ä¾èµ–é¡¹

```toml
# chess-client/Cargo.toml
[dependencies]
chess-ai = { path = "../chess-ai" }  # æ–°å¢
futures-lite = "2.0"                 # æ–°å¢ï¼ˆç”¨äº poll_onceï¼‰
```

### C. å‚è€ƒèµ„æ–™

- Bevy å¼‚æ­¥ä»»åŠ¡ï¼šhttps://docs.rs/bevy/latest/bevy/tasks/
- chess-ai æ–‡æ¡£ï¼š`../chess-ai/README.md`
- ç°æœ‰ AI å®ç°ï¼š`chess-server/src/server.rs:530-651`

---

**æ–‡æ¡£ç»“æŸ**
